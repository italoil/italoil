<section class="section" style="background-color: var(--color-secondary);">
  <div class="container">
    <h2 style="text-align: center; margin-bottom: 4rem;">
      {{ section.settings.heading | default: 'You May Also Like' }}
    </h2>

    {%- if recommendations.performed and recommendations.products_count > 0 -%}
      <div class="grid grid--{{ section.settings.products_to_show | at_most: 4 }}-col">
        {%- for product in recommendations.products limit: section.settings.products_to_show -%}
          <div class="product-card">
            <div class="product-card__image-wrapper">
              <a href="{{ product.url }}">
                {%- if product.featured_image -%}
                  <img 
                    src="{{ product.featured_image | image_url: width: 600 }}"
                    alt="{{ product.featured_image.alt | escape }}"
                    class="product-card__image"
                    loading="lazy"
                  >
                {%- else -%}
                  {{ 'product-1' | placeholder_svg_tag: 'product-card__image' }}
                {%- endif -%}
              </a>
            </div>

            <div class="product-card__content">
              <h3 class="product-card__title">
                <a href="{{ product.url }}">{{ product.title }}</a>
              </h3>

              <div class="product-card__price">
                {{ product.price | money }}
              </div>

              <a href="{{ product.url }}" class="button button--full">
                View Product
              </a>
            </div>
          </div>
        {%- endfor -%}
      </div>
    {%- endif -%}
  </div>
</section>

{% schema %}
{
  "name": "Product Recommendations",
  "tag": "section",
  "class": "product-recommendations",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "You May Also Like"
    },
    {
      "type": "range",
      "id": "products_to_show",
      "min": 2,
      "max": 4,
      "step": 1,
      "label": "Products to Show",
      "default": 4
    }
  ]
}
{% endschema %}
